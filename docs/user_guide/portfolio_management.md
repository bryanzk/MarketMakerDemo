# Portfolio Management User Guide / 组合管理用户指南

## 概述

本指南介绍如何使用 AlphaLoop 的**组合管理**功能来监控和管理多个交易策略。组合管理视图让您可以在一个页面上看到所有策略的整体表现，并进行策略间的对比分析。

---

## 1. Portfolio Overview / 组合概览

### 1.1 功能说明

Portfolio Overview 位于页面顶部，提供所有运行中策略的汇总视图。

![Portfolio Overview](../images/portfolio_overview.png)

### 1.2 核心指标

| 指标 | 说明 | 计算方式 |
|------|------|----------|
| **Total PnL** | 所有策略的总盈亏 | Σ(各策略 Realized PnL) |
| **Portfolio Sharpe** | 组合风险调整后收益 | 基于组合整体收益率计算 |
| **Active Strategies** | 正在运行的策略数量 | 状态为 LIVE 的策略计数 |
| **Portfolio Risk** | 整体风险等级 | 基于最大回撤和仓位综合评估 |

### 1.3 使用场景

**场景 A：日常监控**
> 作为交易员，我每天早上打开仪表盘，首先查看 Portfolio Overview 了解整体盈亏情况，确认所有策略是否正常运行。

**场景 B：风险预警**
> 当 Portfolio Risk 显示为 "High" 或 "Critical" 时，我需要立即查看各策略详情，决定是否需要暂停某些策略。

**场景 C：绩效汇报**
> 月末需要汇报整体交易绩效时，Portfolio Overview 提供了一目了然的汇总数据。

### 1.4 操作指南

1. **查看组合概览**
   - 打开 AlphaLoop 仪表盘
   - Portfolio Overview 自动显示在页面顶部
   - 数据每秒自动刷新

2. **理解风险等级**
   - 🟢 **Low**：所有指标正常，无需操作
   - 🟡 **Medium**：部分指标接近阈值，建议关注
   - 🔴 **High**：存在风险，建议审查策略配置
   - ⚫ **Critical**：严重风险，建议立即暂停策略

---

## 2. Strategy Comparison Table / 策略对比表

### 2.1 功能说明

策略对比表以表格形式展示所有策略的关键指标，支持快速对比和管理操作。

### 2.2 表格列说明

| 列名 | 说明 | 示例值 |
|------|------|--------|
| **Strategy** | 策略名称 | Fixed Spread |
| **Status** | 运行状态 | 🟢 LIVE / 🟡 PAPER / 🔴 PAUSED |
| **PnL** | 该策略的已实现盈亏 | +$156.78 |
| **Sharpe** | 该策略的夏普比率 | 2.1 |
| **Health** | 策略健康度评分 (0-100) | 85 |
| **Allocation** | 分配给该策略的资金比例 | 60% |
| **ROI** | 投资回报率 | 2.6% |
| **Actions** | 操作按钮 | [暂停] [详情] |

### 2.3 策略状态说明

| 状态 | 图标 | 说明 |
|------|------|------|
| **LIVE** | 🟢 | 策略正在实盘运行 |
| **PAPER** | 🟡 | 策略在模拟模式运行 |
| **PAUSED** | 🔴 | 策略已暂停，不下单 |
| **STOPPED** | ⚫ | 策略已停止 |

### 2.4 健康度评分

健康度是一个 0-100 的综合评分，基于以下因素计算：

- **盈利能力** (权重 40%)：基于 PnL 正负和大小
- **风险调整收益** (权重 30%)：基于 Sharpe Ratio
- **执行质量** (权重 20%)：基于 Fill Rate 和 Slippage
- **稳定性** (权重 10%)：基于 Max Drawdown

| 评分范围 | 状态 | 建议操作 |
|----------|------|----------|
| 80-100 | 优秀 | 可考虑增加资金分配 |
| 60-79 | 良好 | 保持现状 |
| 40-59 | 一般 | 需要关注和优化 |
| 0-39 | 较差 | 建议暂停或调整 |

### 2.5 使用场景

**场景 A：策略对比决策**
> 我有两个策略同时运行，想知道哪个表现更好。通过对比表，我可以快速看到各策略的 Sharpe、PnL 和健康度，决定是否调整资金分配。

**场景 B：问题策略定位**
> 当 Portfolio 整体表现下滑时，我需要快速找出是哪个策略拖累了整体收益。对比表按 PnL 排序，问题策略一目了然。

**场景 C：新策略评估**
> 新上线一个策略后，我在对比表中可以与成熟策略进行对比，评估新策略的表现是否达标。

### 2.6 操作指南

1. **查看策略对比**
   - 策略对比表位于 Portfolio Overview 下方
   - 点击表头可按该列排序

2. **暂停策略**
   - 点击策略行的 [暂停] 按钮
   - 确认对话框后策略进入 PAUSED 状态
   - 暂停期间策略不会下新订单

3. **查看策略详情**
   - 点击策略行的 [详情] 按钮
   - 跳转到该策略的专属 Tab 页

4. **筛选策略**
   - 使用状态筛选下拉框选择要显示的策略状态
   - 可以只显示 LIVE 策略，排除已暂停的

---

## 3. 常见问题

### Q1: Portfolio Sharpe 与单个策略 Sharpe 的关系？
Portfolio Sharpe 是基于组合整体收益率计算的，不是各策略 Sharpe 的简单平均。低相关性的策略组合可以获得更高的 Portfolio Sharpe。

### Q2: 策略健康度多久更新一次？
健康度每 5 秒更新一次，基于最近的交易数据计算。

### Q3: 如何调整策略资金分配？
目前资金分配在策略配置中设定。未来版本将支持在对比表中直接调整分配比例。

### Q4: 暂停策略后会发生什么？
暂停后，策略的现有订单会被取消，不会再下新订单。但历史数据和统计会保留。

---

## 4. 快捷键

| 快捷键 | 功能 |
|--------|------|
| `R` | 刷新所有数据 |
| `1` | 切换到 Fixed Spread Tab |
| `2` | 切换到 Funding Rate Tab |
| `3` | 切换到 Dashboard Tab |

---

## 5. API 参考

如果您需要通过 API 获取组合数据，请参考：

```bash
# 获取组合概览
GET /api/portfolio

# 响应示例
{
  "total_pnl": 234.56,
  "portfolio_sharpe": 2.3,
  "active_count": 2,
  "total_count": 2,
  "risk_level": "low",
  "strategies": [
    {
      "id": "fixed_spread",
      "name": "Fixed Spread",
      "status": "live",
      "pnl": 156.78,
      "sharpe": 2.1,
      "health": 85,
      "allocation": 0.6,
      "roi": 0.026
    },
    {
      "id": "funding_rate",
      "name": "Funding Rate",
      "status": "live",
      "pnl": 77.78,
      "sharpe": 2.5,
      "health": 88,
      "allocation": 0.4,
      "roi": 0.019
    }
  ]
}
```

---

## 更新日志

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2024-01 | 初始版本：Portfolio Overview + 策略对比表 |


