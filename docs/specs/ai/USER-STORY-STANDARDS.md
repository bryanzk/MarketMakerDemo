# User Story Standards / ç”¨æˆ·æ•…äº‹æ ‡å‡†

**Source / æ¥æº**: Classic Software Development Literature / ç»å…¸è½¯ä»¶å¼€å‘æ–‡çŒ®  
**Last Updated / æœ€åæ›´æ–°**: 2025-11-30  
**Maintained by / ç»´æŠ¤è€…**: Agent PO

---

## ğŸ“š ç»å…¸æ ‡å‡†æ¦‚è§ˆ / Classic Standards Overview

### 1. INVEST åŸåˆ™ / INVEST Principle

**Origin / æ¥æº**: Bill Wake (2003) - "INVEST in Good Stories, and SMART Tasks"

INVEST æ˜¯è¯„ä¼°ç”¨æˆ·æ•…äº‹è´¨é‡çš„å…­ä¸ªæ ‡å‡†ï¼š

| æ ‡å‡† | è‹±æ–‡ | ä¸­æ–‡ | è¯´æ˜ |
|------|------|------|------|
| **I** | **Independent** | **ç‹¬ç«‹æ€§** | ç”¨æˆ·æ•…äº‹åº”å½“èƒ½å¤Ÿç‹¬ç«‹å­˜åœ¨å’Œå®ç°ï¼Œé¿å…ä¸å…¶ä»–æ•…äº‹è¿‡åº¦ä¾èµ– |
| **N** | **Negotiable** | **å¯åå•†æ€§** | ç”¨æˆ·æ•…äº‹åº”å½“æ˜¯ç®€æ´çš„éœ€æ±‚æè¿°ï¼Œå…·ä½“ç»†èŠ‚å¯é€šè¿‡è®¨è®ºç¡®å®š |
| **V** | **Valuable** | **æœ‰ä»·å€¼æ€§** | æ¯ä¸ªç”¨æˆ·æ•…äº‹éƒ½åº”ä¸ºç”¨æˆ·æˆ–å®¢æˆ·æä¾›æ˜ç¡®çš„ä»·å€¼ |
| **E** | **Estimable** | **å¯ä¼°ç®—æ€§** | ç”¨æˆ·æ•…äº‹åº”å½“è¶³å¤Ÿæ¸…æ™°ï¼Œä»¥ä¾¿å›¢é˜Ÿèƒ½å¤Ÿå¯¹å…¶å·¥ä½œé‡è¿›è¡Œåˆç†ä¼°ç®— |
| **S** | **Small** | **å°å‹åŒ–** | ç”¨æˆ·æ•…äº‹çš„è§„æ¨¡åº”å½“é€‚ä¸­ï¼Œé€šå¸¸èƒ½å¤Ÿåœ¨ä¸€ä¸ªè¿­ä»£å†…å®Œæˆ |
| **T** | **Testable** | **å¯æµ‹è¯•æ€§** | ç”¨æˆ·æ•…äº‹åº”å½“åŒ…å«æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†ï¼Œä»¥ä¾¿äºæµ‹è¯•å’ŒéªŒè¯ |

---

### 2. 3Cs åŸåˆ™ / 3Cs Principle

**Origin / æ¥æº**: Ron Jeffries (2001) - "Essential XP: Card, Conversation, Confirmation"

ç”¨æˆ·æ•…äº‹åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ ï¼š

| C | è‹±æ–‡ | ä¸­æ–‡ | è¯´æ˜ |
|---|------|------|------|
| **Card** | Card | å¡ç‰‡ | ç”¨æˆ·æ•…äº‹çš„ç®€çŸ­ä¹¦é¢æè¿°ï¼ˆé€šå¸¸å†™åœ¨ç´¢å¼•å¡ä¸Šï¼‰ |
| **Conversation** | Conversation | å¯¹è¯ | å¼€å‘å›¢é˜Ÿä¸åˆ©ç›Šç›¸å…³è€…ä¹‹é—´çš„è®¨è®ºï¼Œæ¾„æ¸…éœ€æ±‚ç»†èŠ‚ |
| **Confirmation** | Confirmation | ç¡®è®¤ | æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†ï¼Œç”¨äºç¡®è®¤æ•…äº‹å·²å®Œæˆ |

---

### 3. æ ‡å‡†æ ¼å¼ / Standard Format

**Origin / æ¥æº**: Mike Cohn (2004) - "User Stories Applied"

ç»å…¸çš„ç”¨æˆ·æ•…äº‹æ ¼å¼ï¼š

```
As a {role},
I want {functionality},
So that {benefit}.
```

**ä¸­æ–‡æ ¼å¼**ï¼š
```
ä½œä¸º {è§’è‰²}ï¼Œ
æˆ‘æƒ³è¦ {åŠŸèƒ½}ï¼Œ
ä»¥ä¾¿ {æ”¶ç›Š}ã€‚
```

---

## âœ… å¥½çš„ç”¨æˆ·æ•…äº‹çš„ç‰¹å¾ / Characteristics of Good User Stories

### 1. æ¸…æ™°ç®€æ´ / Clear and Concise

- âœ… ä½¿ç”¨ç®€å•æ˜äº†çš„è¯­è¨€
- âœ… é¿å…æŠ€æœ¯æœ¯è¯­
- âœ… ä½¿æ‰€æœ‰å›¢é˜Ÿæˆå‘˜éƒ½èƒ½ç†è§£

**Example / ç¤ºä¾‹**:
```
âœ… Good: "As a trader, I want to switch between Binance and Hyperliquid, so that I can trade on different exchanges."

âŒ Bad: "As a trader, I want to implement a polymorphic exchange client factory pattern with dependency injection, so that I can abstract exchange-specific implementations."
```

---

### 2. ç”¨æˆ·å¯¼å‘ / User-Oriented

- âœ… ä»ç”¨æˆ·çš„è§’åº¦æè¿°éœ€æ±‚
- âœ… æ˜ç¡®è°æ˜¯ç”¨æˆ·
- âœ… æ˜ç¡®ç”¨æˆ·çš„ç›®æ ‡
- âœ… æ˜ç¡®ç”¨æˆ·å¸Œæœ›è·å¾—çš„ä»·å€¼

**Example / ç¤ºä¾‹**:
```
âœ… Good: "As a quantitative trader, I want to see real-time PnL metrics, so that I can monitor my trading performance."

âŒ Bad: "The system should display PnL calculations in the database."
```

---

### 3. å¯æµ‹è¯•æ€§ / Testable

- âœ… åŒ…å«æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†
- âœ… éªŒæ”¶æ ‡å‡†å¯éªŒè¯
- âœ… æœ‰æ˜ç¡®çš„æˆåŠŸ/å¤±è´¥æ¡ä»¶

**Example / ç¤ºä¾‹**:
```
âœ… Good:
- [ ] Connection retries up to 3 times with exponential backoff (1s, 2s, 4s)
- [ ] Health check endpoint returns 200 OK when connected, 503 when disconnected

âŒ Bad:
- [ ] Connection should be reliable (too vague)
- [ ] System should work well (not measurable)
```

---

### 4. ç‹¬ç«‹æ€§ / Independent

- âœ… å°½é‡ä½¿æ¯ä¸ªç”¨æˆ·æ•…äº‹ç‹¬ç«‹å­˜åœ¨
- âœ… å‡å°‘ä¸å…¶ä»–æ•…äº‹çš„ä¾èµ–
- âœ… æ–¹ä¾¿å•ç‹¬å¼€å‘å’Œæµ‹è¯•

**Example / ç¤ºä¾‹**:
```
âœ… Good: "As a trader, I want to place limit orders, so that I can control my entry price."

âŒ Bad: "As a trader, I want to place limit orders (depends on US-001: Exchange Connection), so that I can control my entry price."
```

**Note / æ³¨æ„**: å¦‚æœå­˜åœ¨ä¾èµ–ï¼Œåº”åœ¨éªŒæ”¶æ ‡å‡†ä¸­æ˜ç¡®è¯´æ˜ï¼Œä½†å°½é‡è®¾è®¡ä¸ºå¯ç‹¬ç«‹æµ‹è¯•ã€‚

---

### 5. å¯ä¼°ç®—æ€§ / Estimable

- âœ… è¶³å¤Ÿå…·ä½“ï¼Œä½¿å¼€å‘å›¢é˜Ÿèƒ½å¤Ÿä¼°ç®—å®ç°æ‰€éœ€çš„æ—¶é—´å’Œèµ„æº
- âœ… è§„æ¨¡é€‚ä¸­ï¼Œé€šå¸¸èƒ½å¤Ÿåœ¨ä¸€ä¸ªè¿­ä»£å†…å®Œæˆ
- âœ… é¿å…è¿‡äºåºå¤§æˆ–è¿‡äºç»†ç¢

**Example / ç¤ºä¾‹**:
```
âœ… Good: "As a trader, I want to cancel all open orders, so that I can quickly exit all positions."

âŒ Bad: "As a trader, I want a complete trading platform with all features." (too large)
âŒ Bad: "As a trader, I want a button to click." (too small, missing context)
```

---

### 6. å¯åå•†æ€§ / Negotiable

- âœ… æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ä»¥å¼•å‘å›¢é˜Ÿä¸åˆ©ç›Šç›¸å…³è€…ä¹‹é—´çš„è®¨è®º
- âœ… ä¸åº”è¿‡äºè¯¦ç»†ï¼Œä»¥ä¿ç•™çµæ´»æ€§
- âœ… å…·ä½“ç»†èŠ‚é€šè¿‡å¯¹è¯ç¡®å®š

**Example / ç¤ºä¾‹**:
```
âœ… Good: "As a trader, I want to see my portfolio balance, so that I can monitor my capital."

âŒ Bad: "As a trader, I want to see my portfolio balance displayed in a 12px Arial font, centered on the page, with a blue background, updated every 100ms, so that I can monitor my capital." (too prescriptive)
```

---

## ğŸ“‹ éªŒæ”¶æ ‡å‡†æœ€ä½³å®è·µ / Acceptance Criteria Best Practices

### ç‰¹å¾ / Characteristics

æ ¹æ®ç»å…¸æ–‡çŒ®å’Œé¡¹ç›®å®è·µï¼Œè‰¯å¥½çš„éªŒæ”¶æ ‡å‡†åº”å…·å¤‡ï¼š

| ç‰¹å¾ | è‹±æ–‡ | ä¸­æ–‡ | è¯´æ˜ |
|------|------|------|------|
| **Testable** | Testable | å¯æµ‹è¯• | å¯ä»¥é€šè¿‡æµ‹è¯•éªŒè¯ |
| **Measurable** | Measurable | å¯è¡¡é‡ | æœ‰æ˜ç¡®çš„æˆåŠŸ/å¤±è´¥æ¡ä»¶ |
| **Specific** | Specific | å…·ä½“ | ä¸æ¨¡ç³Šæˆ–å«ç³Šä¸æ¸… |
| **Independent** | Independent | ç‹¬ç«‹ | å¯ä»¥å•ç‹¬éªŒè¯ |

---

### æ ¼å¼ / Format

**Given-When-Then æ ¼å¼** (BDD - Behavior Driven Development):

```
Given {precondition}
When {action}
Then {expected result}
```

**ä¸­æ–‡æ ¼å¼**:
```
Given {å‰ç½®æ¡ä»¶}
When {æ“ä½œ}
Then {é¢„æœŸç»“æœ}
```

**Example / ç¤ºä¾‹**:
```
### AC-1: Connection Retry Logic / è¿æ¥é‡è¯•é€»è¾‘

**Given** the exchange API is temporarily unavailable  
**When** the system attempts to connect  
**Then** it should retry up to 3 times with exponential backoff (1s, 2s, 4s)

**Given** äº¤æ˜“æ‰€ API æš‚æ—¶ä¸å¯ç”¨  
**When** ç³»ç»Ÿå°è¯•è¿æ¥  
**Then** åº”è¯¥é‡è¯•æœ€å¤š 3 æ¬¡ï¼Œä½¿ç”¨æŒ‡æ•°é€€é¿ï¼ˆ1ç§’ã€2ç§’ã€4ç§’ï¼‰
```

---

## ğŸ” è¯„ä¼°æ£€æŸ¥æ¸…å• / Evaluation Checklist

### ç”¨æˆ·æ•…äº‹è´¨é‡æ£€æŸ¥ / User Story Quality Check

- [ ] **Independent / ç‹¬ç«‹æ€§**: æ•…äº‹å¯ä»¥ç‹¬ç«‹å®ç°ï¼Œä¸ä¾èµ–å…¶ä»–æœªå®Œæˆçš„æ•…äº‹
- [ ] **Negotiable / å¯åå•†æ€§**: æ•…äº‹ç®€æ´ï¼Œç»†èŠ‚å¯é€šè¿‡è®¨è®ºç¡®å®š
- [ ] **Valuable / æœ‰ä»·å€¼æ€§**: æ•…äº‹ä¸ºç”¨æˆ·æä¾›æ˜ç¡®çš„ä»·å€¼
- [ ] **Estimable / å¯ä¼°ç®—æ€§**: å›¢é˜Ÿèƒ½å¤Ÿä¼°ç®—å·¥ä½œé‡
- [ ] **Small / å°å‹åŒ–**: å¯ä»¥åœ¨ä¸€ä¸ªè¿­ä»£å†…å®Œæˆï¼ˆé€šå¸¸ 1-3 å¤©ï¼‰
- [ ] **Testable / å¯æµ‹è¯•æ€§**: æœ‰æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†

### æ ¼å¼æ£€æŸ¥ / Format Check

- [ ] éµå¾ª "As a... I want... So that..." æ ¼å¼
- [ ] è§’è‰²ï¼ˆPersonaï¼‰æ¸…æ™°æ˜ç¡®
- [ ] åŠŸèƒ½æè¿°å…·ä½“
- [ ] æ”¶ç›Šé™ˆè¿°æ¸…æ™°

### éªŒæ”¶æ ‡å‡†æ£€æŸ¥ / Acceptance Criteria Check

- [ ] æ¯ä¸ªéªŒæ”¶æ ‡å‡†å¯æµ‹è¯•
- [ ] æ¯ä¸ªéªŒæ”¶æ ‡å‡†å¯è¡¡é‡
- [ ] æ¯ä¸ªéªŒæ”¶æ ‡å‡†å…·ä½“æ˜ç¡®
- [ ] éªŒæ”¶æ ‡å‡†ç‹¬ç«‹å¯éªŒè¯
- [ ] ä½¿ç”¨ Given-When-Then æ ¼å¼ï¼ˆæ¨èï¼‰

---

## ğŸ“Š é¡¹ç›®ä¸­çš„å®è·µ / Project Practice

### ä¸ç»å…¸æ ‡å‡†çš„å¯¹æ¯” / Comparison with Classic Standards

| æ ‡å‡† | ç»å…¸è¦æ±‚ | é¡¹ç›®è¦æ±‚ | çŠ¶æ€ |
|------|---------|---------|------|
| **INVEST** | 6 ä¸ªæ ‡å‡† | âœ… å…¨éƒ¨é‡‡ç”¨ | âœ… ä¸€è‡´ |
| **3Cs** | Card, Conversation, Confirmation | âœ… é‡‡ç”¨ï¼ˆCard + Confirmationï¼‰ | âœ… ä¸€è‡´ |
| **æ ¼å¼** | "As a... I want... So that..." | âœ… å®Œå…¨ä¸€è‡´ | âœ… ä¸€è‡´ |
| **éªŒæ”¶æ ‡å‡†** | Given-When-Then | âœ… æ¨èä½¿ç”¨ | âœ… ä¸€è‡´ |
| **åŒè¯­** | é€šå¸¸å•è¯­ | âœ… è¦æ±‚åŒè¯­ | â­ å¢å¼º |

---

### é¡¹ç›®ç‰¹æ®Šè¦æ±‚ / Project-Specific Requirements

æ ¹æ® `.cursorrules` å’Œ `docs/agents/AGENT_PO.md`ï¼Œé¡¹ç›®å¯¹ç”¨æˆ·æ•…äº‹æœ‰é¢å¤–è¦æ±‚ï¼š

1. **åŒè¯­æ–‡æ¡£ / Bilingual Documentation**
   - æ‰€æœ‰æ–‡æ¡£å¿…é¡»ä¸­è‹±æ–‡åŒè¯­
   - æ ¼å¼ï¼š`## Title / æ ‡é¢˜`

2. **Metadata / å…ƒæ•°æ®**
   - `parent_feature`: çˆ¶çº§ Feature æˆ– Epic çš„å¼•ç”¨
   - `parent_feature_zh`: çˆ¶çº§ Feature æˆ– Epic çš„ä¸­æ–‡åç§°
   - `module`: æ‰€å±æ¨¡å—
   - `owner_agent`: è´Ÿè´£çš„å¼€å‘ Agent

3. **å±‚çº§å…³ç³» / Hierarchy**
   - æ”¯æŒ Epic â†’ Story å±‚çº§
   - æ”¯æŒ Feature â†’ Story å±‚çº§
   - é€šè¿‡ `parent_feature` å­—æ®µå»ºç«‹å…³ç³»

---

## ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹ / Practical Examples

### Example 1: Good User Story / å¥½çš„ç”¨æˆ·æ•…äº‹ç¤ºä¾‹

```markdown
# US-CORE-004: Hyperliquid Exchange Support / Hyperliquid äº¤æ˜“æ‰€æ”¯æŒ

## Metadata / å…ƒæ•°æ®

- **id**: "US-CORE-004"
- **parent_feature**: "CORE-004: Hyperliquid Exchange Integration"
- **parent_feature_zh**: "CORE-004: Hyperliquid äº¤æ˜“æ‰€é›†æˆ"
- **module**: "trading"
- **owner_agent**: "Agent TRADING"

## User Story / ç”¨æˆ·æ•…äº‹

**As a** quantitative trader  
**I want** to switch between Binance and Hyperliquid exchanges  
**So that** I can trade on different exchanges and diversify my trading options

**ä½œä¸º** é‡åŒ–äº¤æ˜“å‘˜  
**æˆ‘å¸Œæœ›** èƒ½å¤Ÿåœ¨ Binance å’Œ Hyperliquid äº¤æ˜“æ‰€ä¹‹é—´åˆ‡æ¢  
**ä»¥ä¾¿** æˆ‘å¯ä»¥åœ¨ä¸åŒäº¤æ˜“æ‰€äº¤æ˜“å¹¶åˆ†æ•£äº¤æ˜“é€‰æ‹©

## Acceptance Criteria / éªŒæ”¶æ ‡å‡†

### AC-1: Exchange Selection / äº¤æ˜“æ‰€é€‰æ‹©

**Given** the system is configured with both Binance and Hyperliquid credentials  
**When** I select Hyperliquid from the exchange dropdown  
**Then** the system should connect to Hyperliquid API and display connection status

**Given** ç³»ç»Ÿé…ç½®äº† Binance å’Œ Hyperliquid å‡­è¯  
**When** æˆ‘ä»äº¤æ˜“æ‰€ä¸‹æ‹‰èœå•ä¸­é€‰æ‹© Hyperliquid  
**Then** ç³»ç»Ÿåº”è¯¥è¿æ¥åˆ° Hyperliquid API å¹¶æ˜¾ç¤ºè¿æ¥çŠ¶æ€

### AC-2: Order Placement / è®¢å•ä¸‹å•

**Given** I am connected to Hyperliquid  
**When** I place a limit order  
**Then** the order should be placed on Hyperliquid and I should receive order confirmation

**Given** æˆ‘å·²è¿æ¥åˆ° Hyperliquid  
**When** æˆ‘ä¸‹ä¸€ä¸ªé™ä»·å•  
**Then** è®¢å•åº”è¯¥åœ¨ Hyperliquid ä¸Šæ‰§è¡Œï¼Œæˆ‘åº”è¯¥æ”¶åˆ°è®¢å•ç¡®è®¤

### AC-3: Error Handling / é”™è¯¯å¤„ç†

**Given** Hyperliquid API returns an error  
**When** the system processes the error  
**Then** it should display a user-friendly error message in Chinese and English

**Given** Hyperliquid API è¿”å›é”™è¯¯  
**When** ç³»ç»Ÿå¤„ç†é”™è¯¯  
**Then** åº”è¯¥æ˜¾ç¤ºä¸­è‹±æ–‡ç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
```

**è¯„ä¼° / Evaluation**:
- âœ… Independent: å¯ä»¥ç‹¬ç«‹å®ç°
- âœ… Negotiable: ç®€æ´ï¼Œç»†èŠ‚å¯è®¨è®º
- âœ… Valuable: ä¸ºç”¨æˆ·æä¾›ä»·å€¼ï¼ˆå¤šäº¤æ˜“æ‰€æ”¯æŒï¼‰
- âœ… Estimable: å›¢é˜Ÿå¯ä»¥ä¼°ç®—å·¥ä½œé‡
- âœ… Small: å¯ä»¥åœ¨ä¸€ä¸ªè¿­ä»£å†…å®Œæˆ
- âœ… Testable: æœ‰æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†

---

### Example 2: Bad User Story / ä¸å¥½çš„ç”¨æˆ·æ•…äº‹ç¤ºä¾‹

```markdown
# US-BAD-001: Trading System / äº¤æ˜“ç³»ç»Ÿ

## User Story / ç”¨æˆ·æ•…äº‹

**As a** user  
**I want** a trading system  
**So that** I can trade

**ä½œä¸º** ç”¨æˆ·  
**æˆ‘å¸Œæœ›** ä¸€ä¸ªäº¤æ˜“ç³»ç»Ÿ  
**ä»¥ä¾¿** æˆ‘å¯ä»¥äº¤æ˜“

## Acceptance Criteria / éªŒæ”¶æ ‡å‡†

- [ ] System should work
- [ ] ç³»ç»Ÿåº”è¯¥å·¥ä½œ
```

**é—®é¢˜ / Problems**:
- âŒ è§’è‰²ä¸æ˜ç¡®ï¼ˆ"user" å¤ªæ³›ï¼‰
- âŒ åŠŸèƒ½æè¿°ä¸å…·ä½“ï¼ˆ"trading system" å¤ªå®½æ³›ï¼‰
- âŒ æ”¶ç›Šä¸æ¸…æ™°ï¼ˆ"can trade" æ²¡æœ‰è¯´æ˜ä»·å€¼ï¼‰
- âŒ éªŒæ”¶æ ‡å‡†ä¸å¯æµ‹è¯•ï¼ˆ"should work" å¤ªæ¨¡ç³Šï¼‰
- âŒ è§„æ¨¡å¤ªå¤§ï¼ˆæ•´ä¸ªäº¤æ˜“ç³»ç»Ÿï¼‰

---

## ğŸ“š å‚è€ƒæ–‡çŒ® / References

1. **INVEST Principle**
   - Wake, Bill (2003). "INVEST in Good Stories, and SMART Tasks"
   - XP 2003 Conference

2. **3Cs Principle**
   - Jeffries, Ron (2001). "Essential XP: Card, Conversation, Confirmation"
   - Extreme Programming Explained

3. **User Stories Applied**
   - Cohn, Mike (2004). "User Stories Applied: For Agile Software Development"
   - Addison-Wesley Professional

4. **Agile Estimating and Planning**
   - Cohn, Mike (2005). "Agile Estimating and Planning"
   - Prentice Hall

---

**Last Updated / æœ€åæ›´æ–°**: 2025-11-30  
**Maintained by / ç»´æŠ¤è€…**: Agent PO

